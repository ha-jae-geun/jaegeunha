```java
7. 병행제어(Concurrency Control) 기법에 해당하지 않는 것은?
① 로킹기법
② 최적병행수행 기법
③ 타임스램프 기법
```

## Rollback
* 트랜잭션 처리가 비정상으로 종료되어 데이터베이스의 일관성이 깨졌을 때 트랜잭션이 행한 모든 변경 작업을 취소하고 이전 상태로 되돌리는 연산

### 트랜잭션(Transaction)을 사용하며 주의해야 할점?
* 언제나 얻는 것이 있으면 잃는 것도 있다.
* 트랜잭션은 데이터를 완전성을 보장하기 위해 많은 자원들을 사용하게 된다. 자원을 사용하며 Lock을 걸게 되면 다른 사용자들은 Lock이 해제될 때까지 기다려야한다. 기다린다는 것은 성능에 좋지 않다는 의미이다. 따라서 Transaction의 범위를 최소화하여 적용하는 것이 좋다.

## 병행 제어(Concurrency Control)의 개념
- 동시에 여러개의 트랜잭션을 병행 수행할 때, 트랜잭션들이 DB의 일관성을 파괴하지 않도록 트랜잭션 간의 상호작용을 제어하는 것.
- 병행성 : 트랜잭션을 동시에 인터리빙(Interleaving)하게 실행되는 것.
- 인터리빙 : 트랜잭션이 번갈아가며 조금씩 처리를 수행하는 것.

### 병행 제어의 목적
- DB의 공유도 최대화.
- 시스템 활용도 최대화.
- 응답 시간 최소화.
- 단위 시간당 트랜잭션 처리 건수 최대화.
- DB의 일관성 유지

### 병행제어의 필요성
- 갱신 분실 (Lost Update): ・같은 데이터를 공유하여 갱신할 때 갱신 결과의 일부가 사라지는 현상.
- 모순성 (Inconsistency) ・동시에 같은 데이터를 갱신할 때, 데이터의 상호 불일치가 발생하는 현상. ・불일치 분석(Inconsistent Analysis)이라고도 한다.
- 연쇄 복귀 (Cascading Rollback) ・트랜잭션 중 하나에 문제가 생겨 Rollback 되는 경우, 다른 트랜잭션들도 함께 Rollback 되는 현상.

## 병행 제어 기법의 종류

### 2-단계 잠금 규약(Two-Phase Lock Protocol) 기법
- 트랜잭션 스케쥴의 직렬성을 보장하는 대표적인 기법
- 2단계는 다음과 같다.
- 확장(Growing) 단계 : 잠금만 수행할 수 있음. (해제 불가)
- 축소(Shrinking) 단계 : 해제만 수행할 수 있음. (잠금 불가)
- 장점 : 직렬성 보장 / 단점 : 교착 상태 예방 불가능

### 타임 스탬프(Time Stamp Ordering) 기법
- 시스템에 도착한 순서대로 타임 스탬프를 부여하여, 순서대로 실행하도록 한다.
- 교착 상태가 발생하지 않는다.
- 출처: https://cbts.tistory.com/250 [IT일기장]


# Lock
* 트랜잭션이 시작되면 이용하고 있는(Row, Table)은 트랜잭션이 끝날 때 까지 점유한다.

## 로킹
* 상호배제와 접근제어 기능
* Lock을 걸어 그 Lock을 건 트랜잭션만이 Lock을 해제 할 수 있다.
* 하나의 Transaction이 사용하는 DB내의 data를 다른 Transaction이 접근하지 못하게 Lock을 설정하여  다른 Transaction이 접근하지 못하도록 한다. 실행 완료 후엔 Lock을 해제한다.

### 로킹의 특징
* 로킹 단위가 크면 로크 수가 적어 관리하기 쉽지만 병행성 수준이 낮아진다.
* 로킹 단위가 작으면 로크 수가 많아 관리하기는 복잡하지만 병행성 수준이 높아집니다.

### 2단계 로킹 규약(Two-Phase Locking Protocol)
 * 트랜잭션은 lock만 수행할 수 있고, unlock은 수행할 수 없는 확장 단계가 있다.
 * 
 * 확장단계(Growing Phase)
 * Lock을 설정하는 단계
 * 새로운 lock 연산만 수행할 수 있고 unlock 연산은 수행할 수 없는 단계
 * 축소단계(Shirinking Phase)
 * Lock을 해제하는 단계
 * unlock 연산만 실행할 수 있고 일단 unlock 연산을 실행하면 lock 연산은 실행할 수 없는 단계
 * 교착상태(Deadlock)이 발생할 수있다.
 * 
 * 2단계 로킹 규약 준수 o –> 직렬가능 
 * 2단계 로킹 규약 준수 x –> 직렬가능성을 보장 할 수없다. 직렬이 가능할수도, 가능하지 않을수도…
