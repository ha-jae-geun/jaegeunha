# 빌드란
* 사람이 알아 볼 수 있는 원시 파일을 실제 컴퓨터에서 돌릴 수 있게 하는 것을 빌드라고 함
* 소스코드를 실행 가능한 소프트웨어 산출물로 만드는 일련의 과정(jar, war)

# 컴파일
* 작성한 소스 코드를 바이너리 코드로 변환하는 과정
* 빌드의 부분집합
* 사람이 알아볼 수 있는 원시파일을 컴퓨터가 알아들을 수 있는 오브젝트 파일로 만드는 것
* 원시파일 - 컴파일러 - 오브젝트파일 - 링커 - 실행 파일

# 배포
* 작성한 코드를 빌드하고, 빌드가 완성된 실행 가능한 파일을 사용자가 접근할 수 있는 환경에 배치하면 배포가 완료된 것
      * 빌드를 하고 생성된 jar 또는 war 파일을 WAS에 올리는 것이 배포
      * 깃에 올려두고 코드가 제대로 동작하는지 테스트 코드를 작성하고 이를 수행 및 검증하는 작업까지 포함

```java
1. 컴파일(Compile)

컴파일이란 개발자가 작성한 소스코드를 바이너리 코드로 변환하는 과정을 말한다. (목적파일이 생성됨) 

즉, 컴퓨터가 이해할 수 있는 기계어로 변환하는 작업이다. 이러한 작업을 해주는 프로그램을 가르켜 컴파일러(Compiler)라 한다.

자바의 경우, 자바가상머신(JVM)에서 실행가능한 바이트코드 형태의 클래스파일이 생성이 된다.



2. 링크(link)
여러 개로 분리된 소스코드들을 컴파일한 결과물들에서 최종 실행 가능한 파일을 만들기 위해 필요한 부분을 찾아서 연결해주는 작업

프로젝트를 진행하다 보면 소스파일이 여러개가 생성이되고 A라는 소스파일에서 B라는 소스파일에 존재하는 함수(메서드)를 호출하는 경우가 있다.

이때 A와 B 소스파일 각각을 컴파일만 하면 A가 B에 존재하는 함수를 찾질 못하기 때문에 호출할 수가 없다.

따라서 A와 B를 연결해주는 작업이 필요한데 이 작업을 링크라고 한다.

여러개로 분리된 소스파일들을 컴파일한 결과물들에서 최종 실행가능한 파일을 만들기 위해 필요한 부분을 찾아서 연결해주는 작업이다.

링크는 정적링크(static link)와 동적링크(dynamic link)가 있는데

정적링크란 컴파일된 소스파일을 연결해서 실행가능한 파일을 만드는 것이고, 동적링크란 프로그램 실행 도중 프로그램 외부에 
존재하는 코드를 찾아서 연결하는 작업을 말한다.

자바의 경우, JVM이 프로그램 실행 도중 필요한 클래스를 찾아서 클래스패스에 로드해주는데 이는 동적링크의 예이다.



3. 빌드(Build)

소스코드 파일을 실행가능한 소프트웨어 산출물로 만드는 일련의 과정을 말한다. 

빌드의 단계 중 컴파일이 포함이 되어 있는데 컴파일은 빌드의 부분집합이라 할 수 있다.

빌드 과정을 도와주는 도구를 빌드 툴이라 한다.



3-1. 빌드 툴(Build Tool)
소스 코드를 컴파일, 테스트, 정적 분석 등을 실시하여 실행 가능한 애플리케이션으로 자동 생성하는 프로그램

계속해서 늘어나는 라이브러리의 자동 추가 및 관리

라이브러리의 버전을 자동으로 동기화

일반적으로 빌드 툴이 제공해주는 기능으로는 다음과 같은 기능들이 있다.

전처리(preprocessing), 컴파일(Compile), 패키징(packaging), 테스팅(testing), 배포(distribution)

빌드 툴로는 Ant, Maven, Gradle 등이 있다.
```

# 빌드 도구 종류
* 자바
    * ant
        * 현대적인 빌드 도구(최초로 실시)
        * xml 활용
        * 절차적
        * 유연성
            * 빌드 할 때 하나하나 명시를 일일이 해줘야 함
        * 스크립트를 직접 명시
    * 메이븐
        * ant의 유연성을 보완
        * pom.xml
            * pom을 이용하여 빌드 설정
        * 의존성 다운로드 가능
        * 컨벤션
        * 사용자 의도에 맞는 로직
        * 개발이 어려움
    * gradle
        * ant와 메이븐을 보완하기 위해 나옴
        * Groovy / kotlin에 사용
        * 유연성
        * 스크립트의 규모가 작음
            * 의존성을 추가하는 코드 줄이 짧음
* C#
    * MSBuild
* Net framework

## Maven과 Gradle의 차이
* Gradle이 Maven 보다 빌드에 소요되는 시간, 유연성, 종속성 관리 등 다양한 측면에서 뛰어나다는 평가
* 라이브러리가 종속될 경우, 특정 조건을 표현할 경우에 Maven이 이를 처리하기에 복잡하다. 반면 Gradle은 스크립트가 더 짧고 읽기 쉽게 되어있다.
* 라이브러리 의존성 관리
      * Gradle이 Maven보다 더 효율적이고 강력한 기능ㅇ르 제공하고 있다.
      * Gradle은 버전 충돌 또한 관리해준다

## 빌드 도구란
* 소스코드로부터 실행 가능한 어플리케이션을 생성하는 것을 자동화하는 프로그램
    * 자동화: 매번 반복해야 하는 일
```java
예를 들어 보통 jsp/servlet 기반의 Application을 빌드한다.
1. 소스코드를 myBlog.war로 압축한다.
2. myBlog.war을 원격 서버에 deploy한다.
이러한 과정들을 빌드 툴을 사용하면 더 간편하게 가능하다.
```

## 빌드 자동화
    * 의존성 다운로드
    * 소스 코드를 이진 코드로 컴파일
    * 이진 코드 패키징
    * 자동화된 테스트 실행
    * 프로덕션 시스템 배포


# CI(Continuous Integration)
* 개발자를 위한 자동화 프로세스인 지속적 통합으로 모든 개발이 끝난 이후에 코드 품질을 관리한는 고전적 방식의 단점을 해소하기 위해 나타난 개념
* Jenkins, Travis

## CI 프로세스
1. 코드를 통합한다
2. 통합한 코드가 제대로 동작하는지 테스트한다.
3. 제대로 빌드가 되는 지도 테스트한다
4. 결과가 정리하고 버그가 존재한다면 적어둔다

# CD(Continuous Deploy)
* 소프트웨어가 항상 신뢰 가능한 수준에서 배포될 수 있도록 관리하자는 개념

# CI/CD
* 지속적으로 통합하면서 테스트와 빌드를 진행하고 이를 통과한 코드에 대해서 신뢰할 수 있고 바로 배포할 수 있다는 내용

# 무중단 배포
* 기존에 동작하고 있는 서버(배포가 완료된)가 존재 그 상태에서 새롭게 업데이트한 코드를 배포한다면?
   * 충돌이 발생한다. 기존에 서비스 중인 서버를 잠시 내리고 코드를 배포한 후 다시 서버를 동작시켜야 한다
* 8008포트에 서버를 띄운다
      * 새롭게 배포할 내용이 없다면 포트 충돌을 막기 위해서 서버를 다운 시킨다.
      * 8080 포트에 새롭게 배포할 서버를 띄운다
      * 서버가 다시 뜨는데 30초의 시간이 걸린다고 한다면 그 시간만큼 다운 타임(유저에게 서비스가 불가능한 시간)이 발생한다

## 무중단 배포 필요 조건
* 두 대 이상의 서비스해야한다
* 다운 타임이 발생하지 않으려면 실제 서비스 중인 서버와 새롭게 배포한 서버가 동시에 존재해야 한다
* 비용을 줄이려면 배포할 때만 새롭게 서버를 띄우고 배포가 완료된 후에 기존 서버를 죽이면 된다

## Rolling 배포
* 서버 1을 로드 밸런서에서 뺀다
* 서버 1에 배포한다
* 서버 1을 다시 로드 밸런서에 넣는다
* 서버 2를 로드 밸런서에서 뺀다
* 서버 2에 배포한다
* 서버 2를 다시 로드 밸런서에 넣는다

### 단점
* 배포할 서버가 많다면 n대 단위로 배포하기도 하는데 배포가 모두 끝나기 전까지는 누구는 이전 서비스를 받고 누구는 신규 서비스를 받을 수 있다는 문제가 존재한다
* 1대에 배포하는 것보다 최소 2배 이상 느리다


## Canary 배포
* 광부들이 광산에 유독 가스가 나오는 것을 알아내기 위해서 가스에 민감한 카나리아를 광산 안에서 키웠다고 해서 유래된 배포
* 소수의 유저만 사용하는 환경에 신규 버전읇 ㅐ포하고 문제가 없다고 판단됐을 때 다른 모든 서버에 배포한다

## Blue/Green 배포
* 실제로 서비스 중인 환경(Blue)과 새롭게 배포할 환경(Green)을 세트로 준비해서 배포하는 방식

### 장점
* 새롭게 배포할 관경에만 배포하면 되기 때문에 배포 속도가 빠르다
* 언제나 Green 환경이 떠있기 때문에 만약 잘못된 버전으로 배포했을 경우에 신속하게 롤백이 가능하다

### 단점
* Green 환경이 항상 떠있어야 하기 때문에 비용이 두 배로 든다
