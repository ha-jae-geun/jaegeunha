# 인터럽트
## 컴퓨터 시스템의 구조
 * 프로그램이 CPU에서 명령을 수행하려면 수행하려는 주소 영역이 메모리에 올라가 있어야 한다. 
 * 이 때 프로그램의 주소 영역은 크게 코드,데이터,스택 영역으로 구분된다.
 * 코드영역은 우리가 작성한 프로그램 함수들의 코드가 기계어 명령으로 변환되어 저장되는 부분이다.
 * 데이터 영역은 전역 변수 등 프로그램이 사용하는 데이터를 저장하는 부분이다.
 * 스택 영역은 함수가 호출될 때 호출된 함수의 수행을 마치고 복귀할 주소 및 데이터를 임시로 저장하는 데 사용되는 공간이다.
 * 일반적으로 프로그램 내에서 발생되는 함수 호출에 필요한 복귀 주소는 각 프로그램의 주소 공간 중 스택 영역에 보관한다.
 * 반면, 인터럽트 때문에 CPU를 선점당한 위치를 저장하기 위한 공간은 OS 커널 부분에 존재하게 된다.
 * OS는 현재 실행중인 모든 프로그램을 관리하기 위한 자료구조를 유지하고 있다.
    * 예를 들어 A,B 두 개의 프로그램이 현재 수행중이라면  커널 어딘가에 이 두 프로그램을 관리하기 위한 자료 구조가 존재한다.  이 자료 구조를 "프로세스 제어 블록(PCB)"라 부른다.

```java
인터럽트(Interrupt)
 

CPU가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치나

예외상황이 발생하여 처리가 필요할 경우 CPU에게 알려 처리할 수 있도록 하는 것

 
 

인터럽트의 종류
 

 

외부 인터럽트 : 하드웨어가 발생시키는 인터럽트

        // CPU가 아닌 다른 하드웨어 장치가 CPU에 요청하는 경우

 

내부 인터럽트 : CPU 내부에서 실행하면서 인터럽트에 걸리는 경우

        // Divide by Zero, Overflow/Underflow

 

소프트웨어 인터럽트 : 소프트웨어가 발생시키는 인터럽트

        // 예외상황, system call

 

인터럽트의 장점
∝ 프로세서(CPU)가 이벤트 발생 여부를 감시(Polling)할 필요가 없다.

        // 감시를 하는 대신 다른 연산을 수행하므로 효율이 높아진다.

 

인터럽트 과정
1. 인터럽트 요청 신호 발생

2. 프로그램 실행 중단

        // 현재 실행중이던 명령어까지 수행

 

3. 현재 실행중인 프로그램 상태 보관

        // 다음에 실행할 명령어의 번지 보관

 

4. 인터럽트 처리 루틴 실행

        // 인터럽트를 요청한 장치 식별

 

5. 인터럽트 서비스 루틴 처리

        // 인터럽트 원인 파악 및 작업 수행

        // 우선순위가 더 높은 인터럽트가 발생하면 재귀적으로 1 ~ 5 과정 수행

 

6. 상태 복구

        // 보관한 PC의 값을 다시 PC에 저장

 

7. 중단된 프로그램 실행 재개

        // PC의 값을 이용하여 수행중이였던 프로그램 계속 실행
```


## PCB
* 프로그램 A가 수행중에 인터럽트가 발생하면 현재 실행중이던 지점을 A의 프로세스 제어 블록에 저장한 후 인터럽트 처리 루틴으로 가서 인터럽트 발생관련 일 처리를 한다. 인터럽트 처리를 모두 마치면  프로그램 A의 프로세스 제어 블록에 저장된 주소를 복원시켜 원래 수행하던 일을 재개하게 된다.
