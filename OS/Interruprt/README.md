# 문제
```java
28. 다음 중 타이머에 의한 인터럽트(Interrupt)는?  3
① 프로그램 인터럽트 ② I/O 인터럽트
③ 외부 인터럽트 ④ 머신 체크 인터럽트
```

# 인터럽트
## 컴퓨터 시스템의 구조
 * 프로그램이 CPU에서 명령을 수행하려면 수행하려는 주소 영역이 메모리에 올라가 있어야 한다. 
 * 이 때 프로그램의 주소 영역은 크게 코드,데이터,스택 영역으로 구분된다.
 * 코드영역은 우리가 작성한 프로그램 함수들의 코드가 기계어 명령으로 변환되어 저장되는 부분이다.
 * 데이터 영역은 전역 변수 등 프로그램이 사용하는 데이터를 저장하는 부분이다.
 * 스택 영역은 함수가 호출될 때 호출된 함수의 수행을 마치고 복귀할 주소 및 데이터를 임시로 저장하는 데 사용되는 공간이다.
 * 일반적으로 프로그램 내에서 발생되는 함수 호출에 필요한 복귀 주소는 각 프로그램의 주소 공간 중 스택 영역에 보관한다.
 * 반면, 인터럽트 때문에 CPU를 선점당한 위치를 저장하기 위한 공간은 OS 커널 부분에 존재하게 된다.
 * OS는 현재 실행중인 모든 프로그램을 관리하기 위한 자료구조를 유지하고 있다.
    * 예를 들어 A,B 두 개의 프로그램이 현재 수행중이라면  커널 어딘가에 이 두 프로그램을 관리하기 위한 자료 구조가 존재한다.  이 자료 구조를 "프로세스 제어 블록(PCB)"라 부른다.

```java
인터럽트(Interrupt)
 

CPU가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치나

예외상황이 발생하여 처리가 필요할 경우 CPU에게 알려 처리할 수 있도록 하는 것

 
인터럽트란 사전적 의미로는 '끼어들다', '중단시키다' 정도의 의미를 가진 말로 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 
현재 실행중인 작업을 중단하고 발생된 상황을 처리한 후 다시 실행중인 작업으로 복귀하는 것을 말한다.



인터럽트의 종류
인터럽트의 종류는 외부 인터럽트, 내부 인터럽트, 소프트웨어 인터럽트로 나뉠 수 있다.


외부 인터럽트
전원 이상 인터럽트(Power fail interrupt) : 말그대로 정전, 파워 이상 등
기계 착오 인터럽트(Machine check interrupt) : CPU의 기능적인 오류
외부 신호 인터럽트(External interrupt)
- 타이머에 의한 인터럽트 : Preemptive개념을 생각하면 된다. 자원이 할당된 시간이 다 끝난 경우
- 키보드로 인터럽트 키를 누른 경우 : 대표적으로 Control + Alt + Delete
- 외부장치로부터 인터럽트 요청이 있는 경우 : I/O 인터럽트 아님!! 다른 개념이다
입출력 인터럽트(I/O Interrupt)
- 입출력장치가 데이터 전송을 요구하거나 전송이 끝나 다음 동작이 수행되어야 할 경우
- 입출력 데이터에 이상이 있는 경우



내부 인터럽트
잘못된 명령이나 잘못된 데이터를 사용할때 발생하며 Trap이라 부른다.
프로그래 검사 인터럽트(Program check interrupt)
- Division by zero
- Overflow/Underflow
- 기타 Exception
소프트웨어적이 내용이나 분류상 인터럽트가 아니다!


소프트웨어 인터럽트(SVC : SuperVisor Call)
사용자가 프로그램을 실행시키거나 감시프로그램(Supervisor)을 호출하는 동작을 수행하는 경우
소프트웨어 이용중 다른 프로세스를 실행시키면 시분할 처리를 위해 자원 할당 등의 동작이 수행된다.


전원 공급이 이상 → CPU의 기계적인 오류 → 외부 신호에 의한 인터럽트 
→ 입출력 전송 요청 및 전송 완료, 전송 오류 → 프로그램 검사 인터럽트 → 슈퍼바이저 호출(SVC 인터럽트)




인터럽트의 장점
∝ 프로세서(CPU)가 이벤트 발생 여부를 감시(Polling)할 필요가 없다.

        // 감시를 하는 대신 다른 연산을 수행하므로 효율이 높아진다.

 

인터럽트 과정
1. 인터럽트 요청 신호 발생

2. 프로그램 실행 중단

        // 현재 실행중이던 명령어까지 수행

3. 현재 실행중인 프로그램 상태 보관

        // 다음에 실행할 명령어의 번지 보관

4. 인터럽트 처리 루틴 실행
        // 인터럽트를 요청한 장치 식별(식제 인터럽트 작업 아님)

5. 인터럽트 서비스 루틴 처리

        // 인터럽트 원인 파악 및 작업 수행

        // 우선순위가 더 높은 인터럽트가 발생하면 재귀적으로 1 ~ 5 과정 수행

6. 상태 복구

        // 보관한 PC의 값을 다시 PC에 저장

 

7. 중단된 프로그램 실행 재개

        // PC의 값을 이용하여 수행중이였던 프로그램 계속 실행
        
        
        
                
인터럽트 처리 우선순위 결정 방식
(1) 소프트웨어에 의한 방법(폴링 방식)
① 의미：인터럽트가 발생했을 경우, 각 장치를 우선순위에 따라 차례로 검사(폴링;polling)하여 그 중 가장 우선순위가 높은 장치를 찾고 
이에 해당하는 서비스 루틴을 실행하게 한다.

② 장⋅단점
㉠ 장점：하드웨어 가격 저렴, 인터럽트 우선순위 변경의 유연성
㉡ 단점：처리 시간이 오래 걸림(인터럽트 요청 장치가 많을 경우)


(2) 하드웨어에 의한 방법(데이지 체인 방식)
① 의미：모든 장치를 하드웨어적인 방법으로 우선순위에 따라 직렬로 연결하고 CPU는 인터럽트 확인 신호를 순차적으로 통과시켜 
인터럽트를 요청한 장치로부터 인터럽트 벡터주소(VAD)를 받는다.

② 장⋅단점
㉠ 장점：처리 속도가 빠르다.
㉡ 단점：하드웨어 가격이 고가, 인터럽트 우선순위 변경 유연성이 작다.



인터럽트와 서브루틴
서브루틴의 사용：어떤 프로그램 내에서 특정 처리가 여러 번 실행될 필요가 있을 때, 이를 서브루틴으로 작성하여 프로그램 여러 곳에서 호출하여 사용하도록 한다.
```


## PCB
* 프로그램 A가 수행중에 인터럽트가 발생하면 현재 실행중이던 지점을 A의 프로세스 제어 블록에 저장한 후 인터럽트 처리 루틴으로 가서 인터럽트 발생관련 일 처리를 한다. 인터럽트 처리를 모두 마치면  프로그램 A의 프로세스 제어 블록에 저장된 주소를 복원시켜 원래 수행하던 일을 재개하게 된다.
